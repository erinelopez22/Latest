TB_TAGGING

CREATE TABLE #temptable ( [O_DocEntry] int, [DocEntry] int, [WhsCode] varchar(10), [Type] varchar(10), [isHeader] int, [isTotal] int, [Operation] varchar(1) )
INSERT INTO #temptable
VALUES
( 1, 1, '028', 'IS', 0, 1, '+' ), 
( 2, 2, '028', 'IS', 0, 1, '+' ), 
( 3, 1, '028', 'IS', 1, 1, '+' ), 
( 3, 2, '028', 'IS', 1, 1, '+' ), 
( 4, 4, '028', 'IS', 0, 1, '+' ), 
( 5, 5, '028', 'IS', 0, 0, '+' ), 
( 6, 6, '028', 'IS', 0, 0, '+' ), 
( 7, 7, '028', 'IS', 0, 0, '+' ), 
( 8, 8, '028', 'IS', 0, 0, '+' ), 
( 9, 9, '028', 'IS', 0, 0, '+' ), 
( 10, 10, '028', 'IS', 0, 0, '+' ), 
( 11, 11, '028', 'IS', 0, 0, '+' ), 
( 12, 12, '028', 'IS', 0, 0, '+' ), 
( 13, 13, '028', 'IS', 0, 0, '+' ), 
( 14, 14, '028', 'IS', 0, 0, '+' ), 
( 15, 15, '028', 'IS', 0, 0, '+' ), 
( 16, 16, '028', 'IS', 0, 0, '+' ), 
( 17, 17, '028', 'IS', 0, 0, '+' ), 
( 18, 18, '028', 'IS', 0, 0, '+' ), 
( 19, 19, '028', 'IS', 0, 0, '+' ), 
( 20, 5, '028', 'IS', 1, 1, '+' ), 
( 20, 6, '028', 'IS', 1, 1, '+' ), 
( 20, 7, '028', 'IS', 1, 1, '+' ), 
( 20, 8, '028', 'IS', 1, 1, '+' ), 
( 20, 9, '028', 'IS', 1, 1, '+' ), 
( 20, 10, '028', 'IS', 1, 1, '+' ), 
( 20, 11, '028', 'IS', 1, 1, '+' ), 
( 20, 12, '028', 'IS', 1, 1, '+' ), 
( 20, 13, '028', 'IS', 1, 1, '+' ), 
( 20, 14, '028', 'IS', 1, 1, '+' ), 
( 20, 15, '028', 'IS', 1, 1, '+' ), 
( 20, 16, '028', 'IS', 1, 1, '+' ), 
( 20, 17, '028', 'IS', 1, 1, '+' ), 
( 20, 18, '028', 'IS', 1, 1, '+' ), 
( 20, 19, '028', 'IS', 1, 1, '+' ), 
( 21, 3, '028', 'IS', 1, 1, '+' ), 
( 21, 20, '028', 'IS', 1, 1, '-' ), 
( 22, 22, '028', 'IS', 0, 1, '+' ), 
( 23, 23, '028', 'IS', 0, 0, '+' ), 
( 24, 24, '028', 'IS', 0, 0, '+' ), 
( 25, 25, '028', 'IS', 0, 0, '+' ), 
( 26, 26, '028', 'IS', 0, 0, '+' ), 
( 27, 27, '028', 'IS', 0, 0, '+' ), 
( 28, 28, '028', 'IS', 0, 0, '+' ), 
( 29, 29, '028', 'IS', 0, 0, '+' ), 
( 30, 30, '028', 'IS', 0, 0, '+' ), 
( 31, 31, '028', 'IS', 0, 0, '+' ), 
( 32, 32, '028', 'IS', 0, 0, '+' ), 
( 33, 33, '028', 'IS', 0, 0, '+' ), 
( 34, 34, '028', 'IS', 0, 0, '+' ), 
( 35, 35, '028', 'IS', 0, 0, '+' ), 
( 36, 36, '028', 'IS', 0, 0, '+' ), 
( 37, 37, '028', 'IS', 0, 0, '+' ), 
( 38, 38, '028', 'IS', 0, 0, '+' ), 
( 39, 39, '028', 'IS', 0, 0, '+' ), 
( 40, 40, '028', 'IS', 0, 0, '+' ), 
( 41, 41, '028', 'IS', 0, 0, '+' ), 
( 42, 42, '028', 'IS', 0, 0, '+' ), 
( 43, 43, '028', 'IS', 0, 0, '+' ), 
( 44, 44, '028', 'IS', 0, 0, '+' ), 
( 45, 45, '028', 'IS', 0, 0, '+' ), 
( 46, 46, '028', 'IS', 0, 0, '+' ), 
( 47, 47, '028', 'IS', 0, 0, '+' ), 
( 48, 48, '028', 'IS', 0, 0, '+' ), 
( 49, 49, '028', 'IS', 0, 0, '+' ), 
( 50, 50, '028', 'IS', 0, 0, '+' ), 
( 51, 51, '028', 'IS', 0, 0, '+' ), 
( 52, 52, '028', 'IS', 0, 0, '+' ), 
( 53, 53, '028', 'IS', 0, 0, '+' ), 
( 54, 54, '028', 'IS', 0, 0, '+' ), 
( 55, 55, '028', 'IS', 0, 0, '+' ), 
( 56, 56, '028', 'IS', 0, 0, '+' ), 
( 57, 57, '028', 'IS', 0, 0, '+' ), 
( 58, 58, '028', 'IS', 0, 0, '+' ), 
( 59, 59, '028', 'IS', 0, 0, '+' ), 
( 60, 60, '028', 'IS', 0, 0, '+' ), 
( 61, 61, '028', 'IS', 0, 0, '+' ), 
( 62, 62, '028', 'IS', 0, 0, '+' ), 
( 63, 63, '028', 'IS', 0, 0, '+' ), 
( 64, 64, '028', 'IS', 0, 0, '+' ), 
( 65, 65, '028', 'IS', 0, 0, '+' ), 
( 66, 66, '028', 'IS', 0, 0, '+' ), 
( 67, 67, '028', 'IS', 0, 0, '+' ), 
( 68, 68, '028', 'IS', 0, 0, '+' ), 
( 69, 69, '028', 'IS', 0, 0, '+' ), 
( 70, 70, '028', 'IS', 0, 0, '+' ), 
( 71, 22, '028', 'IS', 1, 1, '+' ), 
( 71, 23, '028', 'IS', 1, 1, '+' ), 
( 71, 24, '028', 'IS', 1, 1, '+' ), 
( 71, 25, '028', 'IS', 1, 1, '+' ), 
( 71, 26, '028', 'IS', 1, 1, '+' ), 
( 71, 27, '028', 'IS', 1, 1, '+' ), 
( 71, 28, '028', 'IS', 1, 1, '+' ), 
( 71, 29, '028', 'IS', 1, 1, '+' ), 
( 71, 30, '028', 'IS', 1, 1, '+' ), 
( 71, 31, '028', 'IS', 1, 1, '+' ), 
( 71, 32, '028', 'IS', 1, 1, '+' ), 
( 71, 33, '028', 'IS', 1, 1, '+' ), 
( 71, 34, '028', 'IS', 1, 1, '+' ), 
( 71, 35, '028', 'IS', 1, 1, '+' ), 
( 71, 36, '028', 'IS', 1, 1, '+' ), 
( 71, 37, '028', 'IS', 1, 1, '+' ), 
( 71, 38, '028', 'IS', 1, 1, '+' ), 
( 71, 39, '028', 'IS', 1, 1, '+' ), 
( 71, 40, '028', 'IS', 1, 1, '+' ), 
( 71, 41, '028', 'IS', 1, 1, '+' ), 
( 71, 42, '028', 'IS', 1, 1, '+' ), 
( 71, 43, '028', 'IS', 1, 1, '+' ), 
( 71, 44, '028', 'IS', 1, 1, '+' ), 
( 71, 45, '028', 'IS', 1, 1, '+' ), 
( 71, 46, '028', 'IS', 1, 1, '+' ), 
( 71, 47, '028', 'IS', 1, 1, '+' ), 
( 71, 48, '028', 'IS', 1, 1, '+' ), 
( 71, 49, '028', 'IS', 1, 1, '+' ), 
( 71, 50, '028', 'IS', 1, 1, '+' ), 
( 71, 51, '028', 'IS', 1, 1, '+' ), 
( 71, 52, '028', 'IS', 1, 1, '+' ), 
( 71, 53, '028', 'IS', 1, 1, '+' ), 
( 71, 54, '028', 'IS', 1, 1, '+' ), 
( 71, 55, '028', 'IS', 1, 1, '+' ), 
( 71, 56, '028', 'IS', 1, 1, '+' ), 
( 71, 57, '028', 'IS', 1, 1, '+' ), 
( 71, 58, '028', 'IS', 1, 1, '+' ), 
( 71, 59, '028', 'IS', 1, 1, '+' ), 
( 71, 60, '028', 'IS', 1, 1, '+' ), 
( 71, 61, '028', 'IS', 1, 1, '+' ), 
( 71, 62, '028', 'IS', 1, 1, '+' ), 
( 71, 63, '028', 'IS', 1, 1, '+' ), 
( 71, 64, '028', 'IS', 1, 1, '+' ), 
( 71, 65, '028', 'IS', 1, 1, '+' ), 
( 71, 66, '028', 'IS', 1, 1, '+' ), 
( 71, 67, '028', 'IS', 1, 1, '+' ), 
( 71, 68, '028', 'IS', 1, 1, '+' ), 
( 71, 69, '028', 'IS', 1, 1, '+' ), 
( 71, 70, '028', 'IS', 1, 1, '+' ), 
( 72, 21, '028', 'IS', 1, 1, '+' ), 
( 72, 71, '028', 'IS', 1, 1, '-' ), 
( 73, 73, '028', 'IS', 0, 1, '+' ), 
( 74, 74, '028', 'IS', 1, 1, '+' ), 
( 75, 75, '028', 'IS', 1, 1, '+' ), 
( 76, 76, '028', 'IS', 1, 1, '+' ), 
( 77, 77, '028', 'IS', 1, 1, '+' ), 
( 78, 74, '028', 'IS', 1, 1, '+' ), 
( 78, 75, '028', 'IS', 1, 1, '+' ), 
( 78, 76, '028', 'IS', 1, 1, '+' ), 
( 79, 72, '028', 'IS', 1, 1, '+' ), 
( 79, 79, '028', 'IS', 1, 1, '+' ), 
( 80, 80, '028', 'IS', 0, 1, '+' ), 
( 81, 81, '028', 'IS', 0, 0, '+' ), 
( 82, 82, '028', 'IS', 0, 1, '+' ), 
( 83, 83, '028', 'IS', 0, 0, '+' ), 
( 84, 84, '028', 'IS', 0, 0, '+' ), 
( 85, 85, '028', 'IS', 0, 0, '+' ), 
( 86, 86, '028', 'IS', 0, 0, '+' ), 
( 87, 87, '028', 'IS', 0, 0, '+' ), 
( 88, 88, '028', 'IS', 0, 0, '+' ), 
( 89, 83, '028', 'IS', 1, 1, '+' ), 
( 89, 84, '028', 'IS', 1, 1, '+' ), 
( 89, 85, '028', 'IS', 1, 1, '+' ), 
( 89, 86, '028', 'IS', 1, 1, '+' ), 
( 89, 87, '028', 'IS', 1, 1, '+' ), 
( 89, 88, '028', 'IS', 1, 1, '+' ), 
( 90, 73, '028', 'IS', 1, 1, '+' ), 
( 90, 79, '028', 'IS', 1, 1, '+' ), 
( 90, 89, '028', 'IS', 1, 1, '-' ), 
( 91, 91, '028', 'IS', 0, 1, '+' ), 
( 92, 92, '028', 'IS', 0, 0, '+' ), 
( 93, 93, '028', 'IS', 0, 0, '+' ), 
( 94, 94, '028', 'IS', 0, 0, '+' ), 
( 95, 95, '028', 'IS', 0, 0, '+' ), 
( 96, 96, '028', 'IS', 0, 0, '+' ), 
( 97, 92, '028', 'IS', 1, 1, '+' ), 
( 97, 93, '028', 'IS', 1, 1, '+' ), 
( 97, 94, '028', 'IS', 1, 1, '+' ), 
( 97, 95, '028', 'IS', 1, 1, '+' ), 
( 97, 96, '028', 'IS', 1, 1, '+' ), 
( 98, 90, '028', 'IS', 1, 1, '+' ), 
( 98, 97, '028', 'IS', 1, 1, '-' ), 
( 99, 9, '028', 'IS', 1, 1, '+' ), 
( 99, 40, '028', 'IS', 1, 1, '-' ), 
( 100, 100, '028', 'BS', 1, 0, '+' ), 
( 101, 101, '028', 'BS', 1, 0, '+' ), 
( 102, 102, '028', 'BS', 0, 0, '+' ), 
( 103, 103, '028', 'BS', 0, 0, '+' ), 
( 104, 104, '028', 'BS', 0, 0, '+' ), 
( 105, 105, '028', 'BS', 0, 0, '+' ), 
( 106, 106, '028', 'BS', 0, 0, '+' ), 
( 107, 107, '028', 'BS', 0, 0, '+' ), 
( 108, 102, '028', 'BS', 1, 1, '+' ), 
( 108, 103, '028', 'BS', 1, 1, '+' ), 
( 108, 104, '028', 'BS', 1, 1, '+' ), 
( 108, 105, '028', 'BS', 1, 1, '+' ), 
( 108, 106, '028', 'BS', 1, 1, '+' ), 
( 108, 107, '028', 'BS', 1, 1, '+' ), 
( 109, 109, '028', 'BS', 1, 0, '+' ), 
( 110, 110, '028', 'BS', 0, 0, '+' ), 
( 111, 111, '028', 'BS', 0, 0, '+' ), 
( 112, 112, '028', 'BS', 0, 0, '+' ), 
( 113, 113, '028', 'BS', 0, 0, '+' ), 
( 114, 114, '028', 'BS', 0, 0, '+' ), 
( 115, 110, '028', 'BS', 1, 1, '+' ), 
( 115, 111, '028', 'BS', 1, 1, '+' ), 
( 115, 112, '028', 'BS', 1, 1, '+' ), 
( 115, 113, '028', 'BS', 1, 1, '+' ), 
( 115, 114, '028', 'BS', 1, 1, '+' ), 
( 116, 116, '028', 'BS', 1, 0, '+' ), 
( 117, 117, '028', 'BS', 0, 0, '+' ), 
( 118, 118, '028', 'BS', 0, 0, '+' ), 
( 119, 119, '028', 'BS', 0, 0, '+' ), 
( 120, 120, '028', 'BS', 0, 0, '+' ), 
( 121, 121, '028', 'BS', 0, 0, '+' ), 
( 122, 122, '028', 'BS', 0, 0, '+' ), 
( 123, 117, '028', 'BS', 0, 0, '+' ), 
( 123, 118, '028', 'BS', 0, 0, '+' ), 
( 123, 119, '028', 'BS', 0, 0, '+' ), 
( 123, 120, '028', 'BS', 0, 0, '+' ), 
( 123, 121, '028', 'BS', 0, 0, '+' ), 
( 123, 122, '028', 'BS', 0, 0, '+' ), 
( 124, 124, '028', 'BS', 1, 0, '+' ), 
( 125, 125, '028', 'BS', 0, 0, '+' ), 
( 126, 126, '028', 'BS', 0, 0, '+' ), 
( 127, 127, '028', 'BS', 0, 0, '+' ), 
( 128, 128, '028', 'BS', 0, 0, '+' ), 
( 129, 129, '028', 'BS', 0, 0, '+' ), 
( 130, 130, '028', 'BS', 0, 0, '+' ), 
( 131, 125, '028', 'BS', 1, 1, '+' ), 
( 131, 126, '028', 'BS', 1, 1, '+' ), 
( 131, 127, '028', 'BS', 1, 1, '+' ), 
( 131, 128, '028', 'BS', 1, 1, '+' ), 
( 131, 129, '028', 'BS', 1, 1, '+' ), 
( 131, 130, '028', 'BS', 1, 1, '+' ), 
( 132, 132, '028', 'BS', 1, 0, '+' ), 
( 133, 133, '028', 'BS', 1, 0, '+' ), 
( 134, 134, '028', 'BS', 0, 0, '+' ), 
( 135, 135, '028', 'BS', 0, 0, '+' ), 
( 136, 136, '028', 'BS', 0, 0, '+' ), 
( 137, 137, '028', 'BS', 0, 0, '+' ), 
( 138, 138, '028', 'BS', 0, 0, '+' ), 
( 139, 134, '028', 'BS', 1, 1, '+' ), 
( 139, 135, '028', 'BS', 1, 1, '+' ), 
( 139, 136, '028', 'BS', 1, 1, '+' ), 
( 139, 137, '028', 'BS', 1, 1, '+' ), 
( 139, 138, '028', 'BS', 1, 1, '+' ), 
( 140, 140, '028', 'BS', 1, 0, '+' ), 
( 141, 141, '028', 'BS', 0, 0, '+' ), 
( 142, 142, '028', 'BS', 0, 0, '+' ), 
( 143, 143, '028', 'BS', 0, 0, '+' ), 
( 144, 144, '028', 'BS', 0, 0, '+' ), 
( 145, 145, '028', 'BS', 0, 0, '+' ), 
( 146, 141, '028', 'BS', 1, 1, '+' ), 
( 146, 142, '028', 'BS', 1, 1, '+' ), 
( 146, 143, '028', 'BS', 1, 1, '+' ), 
( 146, 144, '028', 'BS', 1, 1, '+' ), 
( 146, 145, '028', 'BS', 1, 1, '+' ), 
( 147, 139, '028', 'BS', 1, 1, '+' ), 
( 148, 115, '028', 'BS', 1, 1, '+' ), 
( 148, 123, '028', 'BS', 1, 1, '+' ), 
( 148, 131, '028', 'BS', 1, 1, '+' ), 
( 148, 147, '028', 'BS', 1, 1, '+' ), 
( 148, 148, '028', 'BS', 1, 1, '+' ), 
( 149, 149, '028', 'BS', 1, 0, '+' ), 
( 150, 150, '028', 'BS', 1, 0, '+' ), 
( 151, 151, '028', 'BS', 0, 0, '+' ), 
( 152, 152, '028', 'BS', 0, 0, '+' ), 
( 153, 153, '028', 'BS', 0, 0, '+' ), 
( 154, 154, '028', 'BS', 0, 0, '+' ), 
( 155, 155, '028', 'BS', 0, 0, '+' ), 
( 156, 156, '028', 'BS', 0, 0, '+' ), 
( 157, 157, '028', 'BS', 0, 0, '+' ), 
( 158, 158, '028', 'BS', 0, 0, '+' ), 
( 159, 159, '028', 'BS', 0, 0, '+' ), 
( 160, 160, '028', 'BS', 0, 0, '+' ), 
( 161, 161, '028', 'BS', 0, 0, '+' ), 
( 162, 162, '028', 'BS', 0, 0, '+' ), 
( 163, 163, '028', 'BS', 0, 0, '+' ), 
( 164, 164, '028', 'BS', 0, 0, '+' ), 
( 165, 165, '028', 'BS', 0, 0, '+' ), 
( 166, 151, '028', 'BS', 1, 1, '+' ), 
( 166, 152, '028', 'BS', 1, 1, '+' ), 
( 166, 153, '028', 'BS', 1, 1, '+' ), 
( 166, 154, '028', 'BS', 1, 1, '+' ), 
( 166, 155, '028', 'BS', 1, 1, '+' ), 
( 166, 156, '028', 'BS', 1, 1, '+' ), 
( 166, 157, '028', 'BS', 1, 1, '+' ), 
( 166, 158, '028', 'BS', 1, 1, '+' ), 
( 166, 159, '028', 'BS', 1, 1, '+' ), 
( 166, 160, '028', 'BS', 1, 1, '+' ), 
( 166, 161, '028', 'BS', 1, 1, '+' ), 
( 166, 162, '028', 'BS', 1, 1, '+' ), 
( 166, 163, '028', 'BS', 1, 1, '+' ), 
( 166, 164, '028', 'BS', 1, 1, '+' ), 
( 166, 165, '028', 'BS', 1, 1, '+' ), 
( 180, 3, '028', 'IS', 1, 1, '+' ), 
( 181, 20, '028', 'IS', 1, 1, '+' ), 
( 181, 71, '028', 'IS', 1, 1, '+' ), 
( 181, 78, '028', 'IS', 1, 1, '-' ), 
( 181, 89, '028', 'IS', 1, 1, '+' ), 
( 183, 183, '028', 'BS', 1, 0, '+' ), 
( 184, 184, '028', 'BS', 1, 0, '+' ), 
( 185, 185, '028', 'BS', 0, 0, '+' ), 
( 186, 186, '028', 'BS', 0, 0, '+' ), 
( 187, 187, '028', 'BS', 0, 0, '+' ), 
( 188, 188, '028', 'BS', 1, 0, '+' ), 
( 189, 189, '028', 'BS', 0, 0, '+' ), 
( 190, 190, '028', 'BS', 0, 0, '+' ), 
( 191, 191, '028', 'BS', 1, 1, '+' ), 
( 192, 166, '028', 'BS', 1, 1, '+' ), 
( 192, 191, '028', 'BS', 1, 1, '+' ), 
( 193, 148, '028', 'BS', 1, 1, '+' ), 
( 193, 192, '028', 'BS', 1, 1, '-' )

DROP TABLE #temptable